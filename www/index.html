<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <link rel="stylesheet" type="text/css" href="css/main.css" />
        <link rel="stylesheet" type="text/css" href="css/menu.css" />

        <title>Lens</title>
    </head>
    <body>
        <div id="map-canvas"></div>

        <div id="yield"></div>

        <!--
        <div class="menu bottom">
            <div class="menu-listing">Stevens Tour</div>
            <div class="menu-listing">Hoboken Bread Tour</div>
            <div class="menu-listing">Stevens Family Tour</div>
            <div class="menu-listing">Baseball History Tour</div>
            <div class="menu-listing">Sinatra Tour</div>
            <div class="menu-listing">Stevens Athletics Tour</div>
            <div class="menu-listing">Hoboken Garden Tour</div>
        </div>
    -->

        <script type="text/x-handlebars" name="tour-menu">
            <div class="menu bottom">
                {{#each items}}
                    {{{this}}}
                {{/each}}
            </div>
        </script>

        <script type="text/x-handlebars" name="tour-menu-listing">
            <div class="menu-listing">
                <div class="title">{{title}}</div>
                <div class="info">{{distance}}</div>
            </div>
        </script>

        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="phonegap.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript" src="js/include/handlebars.js"></script>
        <script type="text/javascript"
            src="http://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true"></script>
        <script>
            var map;

            function initialize() {
                navigator.geolocation.getCurrentPosition(function(data) {
                    var latitude = data.coords.latitude;
                    var longitude = data.coords.longitude;

                    var mapOptions = {
                        zoom: 8,
                        center: new google.maps.LatLng(latitude, longitude),
                        mapTypeId: google.maps.MapTypeId.ROADMAP
                    };

                    map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
                });
            }
        </script>
        <script type="text/javascript">
            var tours = [
                { title: 'Stevens Tour', distance: '0.3mi' },
                { title: 'Hoboken Bread Tour', distance: '0.3mi' },
                { title: 'Stevens Family Tour', distance: '0.3mi' },
                { title: 'Baseball History Tour', distance: '0.3mi' },
                { title: 'Sinatra Tour', distance: '0.3mi' },
                { title: 'Stevens Athletics Tour', distance: '0.3mi' },
                { title: 'Hoboken Garden Tour', distance: '0.3mi' }
            ];

            function buildTourMenu(tours) {
                var listingElement =
                    document.querySelector('script[name="tour-menu-listing"]');
                var menuElement = document.querySelector('script[name="tour-menu"]');

                var listingTemplate = Handlebars.compile(listingElement.innerHTML);
                var menuTemplate = Handlebars.compile(menuElement.innerHTML);

                var items = [], i;

                for (i = 0; i < tours.length; i++) {
                    items.push(listingTemplate(tours[i]));
                }

                document.querySelector('#yield').innerHTML = menuTemplate({ items: items });
            }

            buildTourMenu(tours);

            app.initialize();
            initialize();
        </script>
    </body>
</html>
